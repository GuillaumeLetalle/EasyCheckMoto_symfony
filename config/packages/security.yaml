security:
    password_hashers:
        Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface: 'auto'

        App\Entity\Client :
            algorithm : auto

        App\Entity\Technicien :
            algorithm : auto
    
    providers:
        users_in_memory : { memory : null }   
        
        app_technicien_provider:
            entity:
                class: App\Entity\Technicien
                property: username

        app_client_provider:
            entity:
                class: App\Entity\Client
                property: username

        chain_provider:
            chain :
                providers : [ app_technicien_provider, app_client_provider ]

    firewalls:
        dev:
            pattern: ^/(_(profiler|wdt)|css|images|js)/
            security: false

        main:
            lazy: true
            form_login: ~
            provider: chain_provider
            custom_authenticator :
                - App\Security\AppAuthenticator
            entry_point : form_login

            logout:
                path: app_logout
                target : app_login
                invalidate_session : true    
            
    role_hierarchy :
        ROLE_CLIENT : ROLE_USER
        # ROLE_TECHNICIEN : ROLE_USER
        ROLE_ADMIN : ROLE_TECHNICIEN
        ROLE_SUPER_ADMIN : [ ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH ]

    access_control:
        - { path : ^/login, roles : PUBLIC_ACCESS }
        - { path: ^/client/new, roles: PUBLIC_ACCESS }
        - { path: ^/technicien, roles: ROLE_TECHNICIEN }
        - { path : ^/ct/new, roles : [ROLE_CLIENT, ROLE_TECHNICIEN] }
        - { path : ^/moto/new, roles : [ROLE_CLIENT, ROLE_TECHNICIEN] }
        - { path : ^/moto, roles : [ROLE_CLIENT, ROLE_ADMIN] }
        - { path: ^/client, roles: [ROLE_CLIENT, ROLE_ADMIN] }

when@test:
    security:
        password_hashers:
            Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface:
                algorithm: auto
                cost: 4 # Lowest possible value for bcrypt
                time_cost: 3 # Lowest possible value for argon
                memory_cost: 10 # Lowest possible value for argon
